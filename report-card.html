<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <title>Internship Report Card Generator | InternSpark</title>

    <!-- SEO Meta -->
    <meta name="description"
        content="Generate and download internship report cards with InternSpark. Create weekly-wise performance report cards, calculate grades, and export verified, A4-ready PDFs for students and colleges.">

    <meta name="keywords"
        content="InternSpark Report Card, Internship Report Card Generator, Weekly Internship Report, Internship Performance Report, Internship Grade Report, Alfido Tech Report Card">

    <meta name="author" content="InternSpark | Alfido Tech">
    <meta name="robots" content="index, follow">

    <!-- Open Graph -->
   <meta property="og:type" content="website">
    <meta property="og:site_name" content="InternSpark">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:title" content="Internship Report Card Generator | InternSpark">
    <meta property="og:description"
        content="Create weekly-wise internship report cards instantly with InternSpark. Download professional, verified A4 PDFs with grades, supervisor remarks, and performance summaries.">
    <meta property="og:url" content="https://www.internspark.in/report-card.html">
    <meta property="og:image" content="https://www.internspark.in/img/og-report-card.webp">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="InternSpark Internship Report Card Generator">
    <meta name="twitter:description"
        content="Generate weekly-wise internship report cards and download verified A4 PDFs using InternSpark. Professional, college-ready performance reports.">
    <meta name="twitter:image" content="https://www.internspark.in/img/og-report-card.webp">




    <!-- Favicon -->
    <link rel="icon" href="/img/favicon/favicon.ico">
    <link rel="icon" type="image/png" sizes="96x96" href="/img/favicon/favicon-96x96.png">
    <link rel="apple-touch-icon" href="/img/favicon/apple-touch-icon.png">
    <link rel="manifest" href="/img/favicon/site.webmanifest">
    <meta name="theme-color" content="#0f0f23">
    <link rel="icon" href="/favicon.ico" sizes="any">
    <link rel="icon" type="image/png" sizes="48x48" href="/favicon.png">
    <link rel="shortcut icon" href="/favicon.ico">


    <!-- ================= SEO & UI ================= -->
    <meta name="google" content="notranslate">
    <meta name="theme-color" content="#0f0f23">
    <link rel="icon" href="/favicon.ico" sizes="any">
    <link rel="icon" type="image/png" sizes="48x48" href="/favicon.png">
    <link rel="shortcut icon" href="/favicon.ico">


    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="css/style.css">

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-519NNPN4L1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-519NNPN4L1');
    </script>
    <style>
        /* =====================================================
   InternSpark â€“ Report Card (CLEAN & FINAL)
   Dark UI (Web) + White PDF (html2pdf)
===================================================== */

        /* ---------- PAGE BASE ---------- */
        body.offer-letter-page {
            background: radial-gradient(circle at top, #0f0f23, #070717);
            color: #e5e7eb;
        }

        /* ---------- LAYOUT ---------- */
        .card-container {
            max-width: 1100px;
            margin: 30px auto;
        }

        /* ---------- REPORT CARD (WEB â€“ DARK) ---------- */
        .report-card {
            position: relative;
            background: linear-gradient(180deg, #0f122b, #0b0d1e);
            color: #e5e7eb;
            padding: 24px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 6px 18px rgba(20, 20, 50, 0.3);
            margin-bottom: 20px;
            page-break-inside: avoid;
            break-inside: avoid;
        }

        .report-card h2,
        .report-card h4,
        .report-card h5 {
            color: #ffffff;
        }

        /* ---------- META ---------- */
        .meta {
            font-size: 13px;
            color: #9ca3af;
        }

        /* ---------- WATERMARK ---------- */
        .watermark {
            position: absolute;
            right: 40px;
            top: 120px;
            font-size: 60px;
            opacity: 0.06;
            pointer-events: none;
            transform: rotate(-12deg);
            z-index: 0;
        }

        /* ---------- TABLE (WEB â€“ DARK) ---------- */
        .table {
            color: #e5e7eb;
        }

        .table thead th {
            background: #111827;
            color: #facc15;
            border: 1px solid #1f2937;
            vertical-align: middle;
        }

        .table tbody td {
            border: 1px solid #1f2937;
        }

        /* ---------- PERFORMANCE COLORS ---------- */
        .text-success {
            color: #22c55e !important;
        }

        .text-primary {
            color: #38bdf8 !important;
        }

        /* ---------- SIGNATURE / QR ---------- */
        .signature-row img {
            height: 70px;
            object-fit: contain;
            margin: 0 8px;
        }

        .qr-holder {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .qrImage {
            border: 1px solid #ccc;
            border-radius: 8px;
            padding: 2px;
            background: #fff;
        }

        /* ---------- PAGE BREAK HELPERS ---------- */
        .page-break {
            page-break-before: always;
            break-before: page;
        }

        .no-break,
        table,
        tr,
        td,
        th {
            page-break-inside: avoid !important;
            break-inside: avoid !important;
        }

        thead {
            display: table-header-group;
        }

        /* =====================================================
   FORCE WHITE MODE FOR PDF (html2pdf)
===================================================== */
        html.pdf-mode body,
        html.pdf-mode .report-card,
        html.pdf-mode #reportsOutput,
        html.pdf-mode table,
        html.pdf-mode th,
        html.pdf-mode td {
            background: #ffffff !important;
            color: #111827 !important;
        }

        /* Card cleanup in PDF */
        html.pdf-mode .report-card {
            border: none !important;
            box-shadow: none !important;
        }

        /* Watermark in PDF */
        html.pdf-mode .watermark {
            opacity: 0.04 !important;
            color: #000 !important;
        }

        /* Tables in PDF */
        html.pdf-mode .table thead th {
            background: #f3f4f6 !important;
            color: #111827 !important;
            border: 1px solid #d1d5db !important;
        }

        html.pdf-mode .table tbody td {
            background: #ffffff !important;
            border: 1px solid #d1d5db !important;
        }

        /* Highlight colors in PDF */
        html.pdf-mode .text-success {
            color: #15803d !important;
        }

        html.pdf-mode .text-primary {
            color: #1d4ed8 !important;
        }

        html.pdf-mode hr {
            border-color: #d1d5db !important;
        }

        /* ===== FORCE WHITE PREVIEW (OPTIONAL MODE) ===== */
        body.white-preview {
            background: #ffffff !important;
            color: #111827 !important;
        }

        body.white-preview .report-card {
            background: #ffffff !important;
            color: #111827 !important;
            border: 1px solid #d1d5db !important;
            box-shadow: none !important;
        }

        body.white-preview .table thead th {
            background: #f3f4f6 !important;
            color: #111827 !important;
        }

        body.white-preview .table tbody td {
            background: #ffffff !important;
            color: #111827 !important;
        }

        body.white-preview .watermark {
            opacity: 0.04 !important;
            color: #000 !important;
        }

        /* =====================================================
   REPORT CARD â€“ CLEAN WHITE UI (WEB + PDF SAFE)
===================================================== */

        /* PAGE BACKGROUND */
        body.report-page {
            background: #f4f6fb !important;
            color: #111827 !important;
        }

        /* MAIN CARD (FORM + REPORT) */
        .report-card {
            background: #ffffff !important;
            color: #111827 !important;
            border: 1px solid #e5e7eb !important;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.06) !important;
        }

        /* HEADINGS */
        .report-card h2,
        .report-card h4,
        .report-card h5 {
            color: #111827 !important;
        }

        /* META TEXT */
        .meta {
            color: #6b7280 !important;
        }

        /* FORMS */
        .form-control,
        .form-select {
            background: #ffffff !important;
            color: #111827 !important;
            border: 1px solid #d1d5db !important;
        }

        .form-control::placeholder {
            color: #9ca3af !important;
        }

        /* TABLE */
        .table {
            background: #ffffff !important;
            color: #111827 !important;
        }

        .table thead th {
            background: #f3f4f6 !important;
            color: #111827 !important;
            border: 1px solid #d1d5db !important;
        }

        .table tbody td {
            background: #ffffff !important;
            border: 1px solid #d1d5db !important;
        }

        /* WATERMARK */
        .watermark {
            opacity: 0.04 !important;
            color: #000 !important;
        }

        /* PERFORMANCE COLORS */
        .text-success {
            color: #15803d !important;
        }

        .text-primary {
            color: #1d4ed8 !important;
        }

        /* HR */
        hr {
            border-color: #e5e7eb !important;
        }
    </style>


</head>

<body class="offer-letter-page report-page">

    <!-- ================= NAVBAR ================= -->
    <nav class="navbar navbar-expand-lg fixed-top bg-black bg-opacity-75 backdrop-blur py-2 shadow">
        <div class="container">

            <!-- Logo -->
            <a class="navbar-brand d-flex align-items-center fw-bold fs-3" href="index.html">
                <img src="img/navbar-logo.webp" alt="InternSpark Logo" height="70" class="me-2">
                <!-- <span style="color:var(--yellow)">Intern<span style="color:#fff">Spark</span> </span> -->
            </a>

            <!-- Mobile Toggle -->
            <button class="navbar-toggler bg-warning border-0 p-2 rounded" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarNav">
                <i class="fas fa-bars text-dark fs-5"></i>
            </button>

            <!-- Menu -->
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto align-items-lg-center gap-lg-2">

                    <li class="nav-item">
                        <a class="nav-link text-white active" href="index.html">Home</a>
                    </li>

                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle text-white" href="#" data-bs-toggle="dropdown">
                            Internship
                        </a>
                        <ul class="dropdown-menu dropdown-menu-dark rounded-4">
                            <li><a class="dropdown-item" href="internship.html">Internship Apply</a></li>

                            <li><a class="dropdown-item" href="internProfile.html">
                                    Intern Profile
                                </a></li>
                            <li><a class="dropdown-item" href="task.html">Tasks</a></li>

                            <li><a class="dropdown-item" href="submission.html">Task Submission</a></li>
                            <li><a class="dropdown-item" href="certificate.html">Certificate</a></li>


                        </ul>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link text-white" href="assessment.html">Assessment</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link text-white" href="contact.html">Contact Us</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link text-white" href="domains.html">Domains</a>
                    </li>

                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle text-white" href="#" data-bs-toggle="dropdown">
                            Resources
                        </a>
                        <ul class="dropdown-menu dropdown-menu-dark rounded-4">
                            <li><a class="dropdown-item" href="offer-letter.html">Offer Letter</a></li>
                            <li><a class="dropdown-item" href="lor.html">Letter of Recommendation</a></li>
                            <li><a class="dropdown-item" href="report-card.html">Report Card</a></li>
                            <li><a class="dropdown-item" href="blog.html">Blog</a></li>
                            <li><a class="dropdown-item" href="code-editor.html">Code Editor</a></li>
                        </ul>
                    </li>

                    <li class="nav-item ms-lg-2">
                        <a class="btn btn-warning fw-bold px-4 py-2 rounded-pill" href="internship.html">
                            Apply Now
                        </a>
                    </li>

                </ul>

            </div>
        </div>
    </nav>
    <br><br>


    <div class="container card-container">
        <div class="report-card">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <div>
                    <!-- <img src="img/navbar-logo.webp" alt="Logo" style="height:60px;"> -->
                </div>
                <div class="text-end">
                    <h5 class="mb-0">Internship Report Card Generator</h5>
                    <div class="meta">InternSpark â€” Generate weekly-wise report cards & download PDF</div>
                </div>
            </div>

            <form id="singleForm" class="row g-3">
                <div class="col-md-4">
                    <label class="form-label">Full Name</label>
                    <input id="name" class="form-control" placeholder="e.g. Ravi Kumar" required>
                </div>
                <div class="col-md-3">
                    <label class="form-label">Candidate ID</label>
                    <input id="candidateId" class="form-control" placeholder="e.g. BS/REG/00001" required>
                </div>
                <div class="col-md-5">
                    <label class="form-label">Domain</label>
                    <select id="domain" class="form-select" required>
                        <option value="" disabled selected>Select domain...</option>
                        <!-- domain list inspired from your uploaded LOR file -->
                        <option>Frontend Developer</option>
                        <option>React.JS</option>
                        <option>MERN Stack Developer</option>
                        <option>Python Developer</option>
                        <option>C++/C Programming</option>
                        <option>Java Developer</option>
                        <option>.NET Developer</option>

                        <option>Data Analytics</option>
                        <option>Business Analytics</option>
                        <option>Data Science</option>
                        <option>Artificial Intelligence</option>
                        <option>Machine Learning</option>

                        <option>Digital Marketing</option>
                        <option>Cybersecurity</option>
                        <option>UX/UI Design</option>
                        <option>Android Developer</option>
                        <option>Web Development</option>

                        <option>Very Large Scale Integration (VLSI)</option>
                        <option>Embedded Systems</option>
                        <option>Cloud Computing</option>
                        <option>DevOps</option>

                        <option>Human Resource(HR)</option>
                    </select>
                </div>

                <div class="col-md-3">
                    <label class="form-label">Start Date</label>
                    <input id="startDate" type="date" class="form-control" required>
                </div>
                <div class="col-md-3">
                    <label class="form-label">End Date</label>
                    <input id="endDate" type="date" class="form-control" required>
                </div>
                <div class="col-md-6">
                    <label class="form-label">Certificate / Post Link</label>
                    <input id="certLink" class="form-control" placeholder="http(s)://... (optional)">
                </div>

                <div class="col-12 d-flex gap-2">
                    <button type="button" class="btn btn-primary" id="generateSingle">Generate Report</button>
                    <input id="csvFile" type="file" accept=".csv" class="form-control-file" style="max-width:260px;">
                    <button type="button" class="btn btn-outline-secondary btn-small" id="generateFromCSV">Generate from
                        CSV</button>
                    <button type="button" class="btn btn-success ms-auto" id="downloadAllPdf"
                        style="display:none;">Download Current PDF</button>
                </div>
                <div class="col-12 mt-2">
                    <small class="text-muted">CSV format columns (header row required):
                        <code>Name,CandidateID,Domain,StartDate,EndDate,CertificateLink</code></small>
                </div>
            </form>
        </div>

        <!-- Reports will be rendered here -->
        <div id="reportsOutput"></div>

        <div class="text-end mb-5">
            <small class="text-muted">Tip: upload a CSV to bulk-generate multiple report cards.</small>
        </div>
    </div>

    <!-- html2pdf for PDF download -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
    <script>
        /**********************
         * Topic bank per domain
         * You can edit these arrays to match your actual weekly syllabus
         **********************/
        const topicsByDomain = {

            "Frontend Developer": [
                "Introduction to Web",
                "HTML Basics",
                "CSS Fundamentals",
                "Bootstrap & Layouts",
                "Responsive Design",
                "JavaScript Basics",
                "DOM Manipulation",
                "Forms & Validation",
                "Version Control (Git)",
                "API Integration",
                "Performance Optimization",
                "Final Project & Review"
            ],
            "Web Development": [
                "Web Fundamentals",
                "HTML5 & CSS3",
                "JavaScript Essentials",
                "Responsive Web Design",
                "Bootstrap Framework",
                "Version Control with Git",
                "Frontend Frameworks Overview",
                "Backend Basics (Node.js/Express)",
                "Database Basics (MongoDB/MySQL)",
                "RESTful APIs",
                "Deployment & Hosting",
                "Final Project"
            ],

            "React.JS": [
                "React Introduction",
                "JSX & Components",
                "Props & State",
                "Event Handling",
                "Hooks (useState, useEffect)",
                "Routing with React Router",
                "Context API",
                "Redux Toolkit Basics",
                "API Integration",
                "Testing",
                "Optimization",
                "Deployment"
            ],

            "MERN Stack Developer": [
                "Web Fundamentals",
                "HTML, CSS & JavaScript",
                "React Frontend",
                "Node.js Basics",
                "Express.js Framework",
                "MongoDB & Mongoose",
                "REST API Development",
                "Authentication & Authorization",
                "JWT & Security",
                "Project Architecture",
                "Deployment",
                "Full Stack Project"
            ],

            "Python Developer": [
                "Python Basics",
                "Data Types & Operators",
                "Control Flow",
                "Functions & Modules",
                "Object-Oriented Programming",
                "File Handling",
                "Exception Handling",
                "Libraries & Packages",
                "Flask / Django Basics",
                "Database Integration",
                "Automation Scripts",
                "Final Project"
            ],

            "C++/C Programming": [
                "Introduction to C/C++",
                "Data Types & Operators",
                "Control Structures",
                "Functions",
                "Pointers & Memory",
                "Structures & Unions",
                "Object-Oriented Concepts",
                "STL Basics",
                "File Handling",
                "Data Structures",
                "Debugging Techniques"
            ],

            "Java Developer": [
                "Java Basics",
                "OOP Concepts",
                "Exception Handling",
                "Collections Framework",
                "Multithreading",
                "JDBC",
                "Servlets & JSP",
                "Spring Framework",
                "Spring Boot",
                "REST APIs",
                "Hibernate",
                "Project Development"
            ],

            ".NET Developer": [
                ".NET Framework Overview",
                "C# Basics",
                "OOP in C#",
                "ASP.NET Core",
                "MVC Architecture",
                "Entity Framework",
                "Web API Development",
                "LINQ",
                "Authentication",
                "Deployment"
            ],

            "Data Analytics": [
                "Introduction to Data Analytics",
                "Excel for Analysis",
                "SQL Fundamentals",
                "Data Cleaning",
                "Data Visualization",
                "Dashboards",
                "Power BI",
                "Tableau",
                "KPIs & Metrics",
                "Data Storytelling"
            ],

            "Business Analytics": [
                "Introduction to Business Analytics",
                "Requirement Gathering",
                "Business KPIs",
                "Data Modelling",
                "Excel & SQL",
                "Power BI",
                "Reporting & Insights",
                "Forecasting",
                "Decision Making",
                "Case Studies"
            ],

            "Data Science": [
                "Introduction to Data Science",
                "Python for Data Science",
                "Data Cleaning",
                "Exploratory Data Analysis",
                "Statistics",
                "Data Visualization",
                "Machine Learning Basics",
                "Feature Engineering",
                "Model Evaluation",
                "Deployment",
                "Capstone Project"
            ],

            "Artificial Intelligence": [
                "Introduction to AI",
                "Problem Solving & Search",
                "Knowledge Representation",
                "Planning Techniques",
                "Neural Networks",
                "Natural Language Processing",
                "Computer Vision",
                "Reinforcement Learning",
                "Ethics in AI",
                "AI Project"
            ],

            "Machine Learning": [
                "Introduction to Machine Learning",
                "Linear Regression",
                "Logistic Regression",
                "Classification Algorithms",
                "Clustering Techniques",
                "Feature Engineering",
                "Model Selection",
                "Deep Learning Basics",
                "TensorFlow / PyTorch",
                "Model Deployment",
                "ML Project"
            ],

            "Digital Marketing": [
                "Introduction to Digital Marketing",
                "SEO Fundamentals",
                "Keyword Research",
                "Content Marketing",
                "Social Media Marketing",
                "Google Ads",
                "Facebook & Instagram Ads",
                "Email Marketing",
                "Affiliate Marketing",
                "Analytics & Reporting",
                "Marketing Automation",
                "Conversion Rate Optimization (CRO)",
                "Online Reputation Management",
                "Campaign Planning",
                "Lead Generation"
            ],

            "Cybersecurity": [
                "Introduction to Cybersecurity",
                "Networking Basics",
                "Types of Threats",
                "Encryption Techniques",
                "Vulnerabilities",
                "Penetration Testing",
                "Firewalls",
                "Ethical Hacking",
                "Incident Response",
                "SOC Operations",
                "Cyber Laws & Compliance"
            ],

            "UX/UI Design": [
                "Introduction to UX/UI",
                "Design Principles",
                "User Research",
                "Wireframing",
                "Figma Basics",
                "Prototyping",
                "Visual Design",
                "Color Theory",
                "Typography",
                "Design Systems",
                "Usability Testing",
                "Portfolio Design"
            ],

            "Android Developer": [
                "Android Introduction",
                "Android Studio Setup",
                "Layouts & Views",
                "Activities & Intents",
                "RecyclerView",
                "API Integration",
                "Firebase",
                "Room Database",
                "Jetpack Components",
                "App Testing",
                "App Publishing"
            ],

            "Very Large Scale Integration (VLSI)": [
                "VLSI Introduction",
                "Digital Electronics",
                "CMOS Fundamentals",
                "Verilog HDL",
                "RTL Design",
                "Synthesis",
                "FPGA Implementation",
                "Timing Analysis",
                "Testing & Validation",
                "VLSI Project"
            ],

            "Embedded Systems": [
                "Introduction to Embedded Systems",
                "Microcontrollers",
                "Embedded C Programming",
                "GPIO & Peripherals",
                "Timers & Interrupts",
                "I2C / SPI / UART",
                "Sensors & Actuators",
                "RTOS Basics",
                "Embedded Project"
            ],

            "Cloud Computing": [
                "Cloud Fundamentals",
                "Virtualization",
                "AWS Basics",
                "Compute Services",
                "Storage Services",
                "Networking & VPC",
                "Identity & Access Management (IAM)",
                "Serverless Computing",
                "Databases in Cloud",
                "CI/CD Pipelines",
                "Monitoring & Logging",
                "Security & Compliance",
                "Cost Optimization",
                "Cloud Architecture",
                "Capstone Project"
            ],

            "DevOps": [
                "DevOps Fundamentals",
                "Linux Basics",
                "Git & GitHub",
                "CI/CD Concepts",
                "Jenkins",
                "Docker",
                "Kubernetes",
                "Infrastructure as Code",
                "Monitoring & Logging",
                "Cloud Integration",
                "DevOps Project"
            ],

            "Human Resource(HR)": [
                "HR Fundamentals",
                "Recruitment & Selection",
                "Employee Onboarding",
                "Performance Management",
                "Compensation & Benefits",
                "Training & Development",
                "HR Analytics",
                "Labor Laws",
                "Employee Engagement",
                "Talent Management",
                "HR Policies",
                "HR Documentation",
                "HRIS Systems",
                "Conflict Resolution",
                "Leadership Development"
            ]

        };


        /**********************
         * deterministic PRNG using candidate id as seed
         **********************/
        function seededRandom(seed) {
            // convert string seed to number deterministically
            let h = 2166136261 >>> 0;
            for (let i = 0; i < seed.length; i++) {
                h = Math.imul(h ^ seed.charCodeAt(i), 16777619);
            }
            return function () {
                h += 0x6D2B79F5 >>> 0;
                let t = Math.imul(h ^ (h >>> 15), 1 | h);
                t ^= t + Math.imul(t ^ (t >>> 7), 61 | t);
                return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
            }
        }

        /**********************
         * helpers for date arithmetic
         **********************/
        function parseDateISO(s) {
            // expects "YYYY-MM-DD"
            const [y, m, d] = s.split("-");
            return new Date(Number(y), Number(m) - 1, Number(d));
        }
        function fmtDate(d) {
            const dd = String(d.getDate()).padStart(2, '0');
            const mm = String(d.getMonth() + 1).padStart(2, '0');
            const yyyy = d.getFullYear();
            return `${dd}/${mm}/${yyyy}`;
        }
        function addDays(d, n) {
            const x = new Date(d);
            x.setDate(x.getDate() + n);
            return x;
        }

        /**********************
 * create weekly breakdown given start & end
 * Weeks are 7-day windows starting from startDate (week 1 = start..start+6)
 **********************/
        function createWeeklyBreakdown(startDateStr, endDateStr, domain, seed) {
            const start = parseDateISO(startDateStr);
            const end = parseDateISO(endDateStr);
            if (end < start) return [];

            const topics = topicsByDomain[domain] || ["Introduction", "Theory", "Practical", "Project"];
            const rand = seededRandom(seed || domain + startDateStr + endDateStr);

            const days = [];
            for (let d = new Date(start); d <= end; d = addDays(d, 1)) {
                days.push(new Date(d));
            }

            // chunk into weeks of 7 days
            const weeks = [];
            for (let i = 0; i < days.length; i += 7) {
                const chunk = days.slice(i, i + 7);
                const weekNo = Math.floor(i / 7) + 1;

                const entries = chunk.map((date, idx) => {
                    const topic = topics[(i + idx) % topics.length];

                    // ðŸ”’ FIXED MARKS LOGIC (85+ only)
                    const r = rand();
                    let marks, remark;
                    marks = Math.floor(85 + r * 16); // 85â€“100
                    remark = "Excellent";

                    return {
                        date: new Date(date),
                        topic,
                        marks,
                        remark
                    };
                });

                weeks.push({
                    weekNo,
                    entries,
                    startDate: chunk[0],
                    endDate: chunk[chunk.length - 1]
                });
            }

            // âœ… RETURN MUST BE INSIDE FUNCTION
            return weeks;
        }
        /**********************
 * Overall Percentage, Grade & Remark Calculator
 **********************/
        function calculateOverallResult(weeks) {
            let totalMarks = 0;
            let totalCount = 0;

            weeks.forEach(week => {
                week.entries.forEach(entry => {
                    totalMarks += entry.marks;
                    totalCount++;
                });
            });

            const percentage = totalCount
                ? (totalMarks / (totalCount * 100)) * 100
                : 0;

            let grade = "A";
            let remarkLine = "Excellent Performance";

            if (percentage >= 90) {
                grade = "A+";
                remarkLine = "Outstanding Performance";
            } else if (percentage >= 85) {
                grade = "A";
                remarkLine = "Excellent Performance";
            }

            return {
                percentage: percentage.toFixed(2),
                grade,
                remarkLine
            };
        }



        /**********************
         * render a single report card DOM
         **********************/
        function renderReportCard(data) {
            // data: { name, candidateId, domain, startDate, endDate, certLink }
            const weeks = createWeeklyBreakdown(data.startDate, data.endDate, data.domain, data.candidateId || data.name);
            const overallResult = calculateOverallResult(weeks);

            const wrapper = document.createElement('div');
            wrapper.className = 'report-card';

            // header
            wrapper.innerHTML = `
        <div style="position:relative;">
          <div class="watermark">InternSpark</div>

          <div class="d-flex justify-content-between align-items-start">
            <div>
              <img src="img/logo1.webp" alt="logo" style="height:70px;">
            </div>
            <div class="text-end">
              <h4 class="mb-0">${escapeHtml(data.name)}</h4>
              <div class="meta">${escapeHtml(data.domain)}</div>
              <div class="meta">Candidate ID: <b>${escapeHtml(data.candidateId)}</b></div>
              <div class="meta">Period: <b>${fmtDate(parseDateISO(data.startDate))}</b> - <b>${fmtDate(parseDateISO(data.endDate))}</b></div>
              ${data.certLink ? `<div class="meta">Cert/Link: <a href="${escapeHtmlAttr(data.certLink)}" target="_blank">View</a></div>` : ''}
            </div>
          </div>

          <div class="text-center my-4">
            <h2 class="mb-3" style="color: #2c3e50; font-weight: 600;">Report Card</h2>
          </div>
          <div class="text-center my-3">
  <h5>
    Overall Percentage:
    <span style="color:#198754;">
      ${overallResult.percentage}%
    </span>
  </h5>
  <h5>
    Grade:
    <span style="color:#0d6efd;">
      ${overallResult.grade}
    </span>
  </h5>
  <p class="fw-semibold text-success">
    ${overallResult.remarkLine}
  </p>
</div>

          <hr>
        <p class="mb-2 meta">Maintor/Supervisor - Akash Dubey (<a href="mailto:akash.dubey@internspark.in">akash.dubey@internspark.in</a>)</p> </br>
        </div>
      `;

            // for each week, create table
            weeks.forEach(week => {
                const weekTitle = document.createElement('div');
                weekTitle.className = 'mb-2';
                weekTitle.innerHTML = `<h6 class="mb-1">Week ${week.weekNo} â€” ${fmtDate(week.startDate)} to ${fmtDate(week.endDate)}</h6>`;

                const table = document.createElement('table');
                table.className = 'table table-sm table-bordered';
                table.innerHTML = `
          <thead class="table-light">
            <tr>
              <th style="width:120px">Date</th>
              <th>Topic / Activity</th>
              <th style="width:100px">Marks</th>
              <th style="width:160px">Remarks</th>
            </tr>
          </thead>
          <tbody></tbody>
        `;
                const tbody = table.querySelector('tbody');
                week.entries.forEach(e => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `<td>${fmtDate(e.date)}</td><td>${escapeHtml(e.topic)}</td><td>${e.marks}</td><td>${escapeHtml(e.remark)}</td>`;
                    tbody.appendChild(tr);
                });

                wrapper.appendChild(weekTitle);
                wrapper.appendChild(table);
            });

            // last page: signature / seal section (keeps it in the same wrapper but classed to allow page break in PDF)
            // last page: signature / seal section
            const lastDiv = document.createElement('div');
            lastDiv.className = 'mt-4 pt-3';
            lastDiv.classList.add('no-break');
            lastDiv.style.borderTop = '1px dashed #ddd';
            lastDiv.innerHTML = `
  <div class="signature-row d-flex flex-wrap align-items-center justify-content-between mt-3 text-center">
      <div class="signature-item1">
          <img src="img/mentor.webp" alt="Founder Signature" style="height:90px;">
          <p class="mt-1"><b>Akash Dubey<br>Maintor/Supervisor</b></p>
      </div>
      
      <div class="signature-item">
          <img src="img/aicte.webp" alt="AICTE Logo" style="height:90px;">
      </div>
      <div class="signature-item qr-holder">
          <canvas class="qrCanvas"></canvas>
          <p class="meta mt-1">Scan to Verify</p>
      </div>
      <div class="signature-item">
          <img src="img/MSME Logo.webp" alt="MSME Logo" style="height:90px;">
      </div>
  </div>
  <div class="mt-3 meta">Generated on: ${fmtDate(new Date())}</div>
`;
            wrapper.appendChild(lastDiv);

            // Generate QR dynamically if certificate link exists
            if (data.certLink) {
                const qrCanvas = lastDiv.querySelector(".qrCanvas");
                const qr = new QRious({
                    element: qrCanvas,
                    value: data.certLink,
                    size: 80
                });
            }



            // add a hidden page-break sentinel to ensure PDF pages split after each report
            const pb = document.createElement('div');
            pb.className = 'page-break';
            wrapper.appendChild(pb);

            return wrapper;
        }

        /**********************
         * escape helpers
         **********************/
        function escapeHtml(str) {
            if (!str && str !== 0) return '';
            return String(str).replace(/[&<>"']/g, function (m) {
                return { '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;' }[m];
            });
        }
        function escapeHtmlAttr(s) { return escapeHtml(s).replace(/"/g, "&quot;"); }

        /**********************
         * generate single / multiple reports
         **********************/
        document.getElementById('generateSingle').addEventListener('click', () => {
            const name = document.getElementById('name').value.trim();
            const candidateId = document.getElementById('candidateId').value.trim();
            const domain = document.getElementById('domain').value;
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            const certLink = document.getElementById('certLink').value.trim();

            if (!name || !candidateId || !domain || !startDate || !endDate) {
                alert('Please fill all required fields.');
                return;
            }

            const data = { name, candidateId, domain, startDate, endDate, certLink };
            const output = document.getElementById('reportsOutput');
            output.innerHTML = ''; // clear
            output.appendChild(renderReportCard(data));
            document.getElementById('downloadAllPdf').style.display = 'inline-block';
            // store for PDF
            window.currentReportHtml = output.innerHTML;
        });

        /**********************
         * CSV parsing & bulk generation
         **********************/
        document.getElementById('generateFromCSV').addEventListener('click', () => {
            const f = document.getElementById('csvFile').files[0];
            if (!f) { alert('Please choose a CSV file (with header).'); return; }

            const reader = new FileReader();
            reader.onload = function (e) {
                try {
                    const text = e.target.result;
                    const rows = csvToObjects(text);
                    if (!rows.length) { alert('No data rows found in CSV.'); return; }
                    const output = document.getElementById('reportsOutput');
                    output.innerHTML = '';
                    rows.forEach(row => {
                        // expect headers: Name,CandidateID,Domain,StartDate,EndDate,CertificateLink
                        const name = row.Name || row.name || row.FullName || row["Full Name"];
                        const candidateId = row.CandidateID || row.CandidateId || row["C.ID"] || row["Candidate Id"] || row["Candidate ID"];
                        const domain = row.Domain || row.domain;
                        const startDate = row.StartDate || row["Start Date"] || row.start;
                        const endDate = row.EndDate || row["End Date"] || row.end;
                        const certLink = row.CertificateLink || row.CertLink || row["Certificate Link"] || row.cert;

                        if (!name || !candidateId || !domain || !startDate || !endDate) {
                            // skip invalid rows but continue
                            console.warn('Skipping invalid CSV row', row);
                            return;
                        }
                        const data = { name, candidateId, domain, startDate, endDate, certLink };
                        output.appendChild(renderReportCard(data));
                    });
                    document.getElementById('downloadAllPdf').style.display = 'inline-block';
                    window.currentReportHtml = output.innerHTML;
                } catch (err) {
                    console.error(err);
                    alert('Failed to parse CSV: ' + err.message);
                }
            };
            reader.readAsText(f, 'UTF-8');
        });

        /**********************
         * CSV -> array of objects (simple parser)
         * Accepts commas & quoted fields, basic handling
         **********************/
        function csvToObjects(csvText) {
            // split lines, handle \r\n or \n
            const lines = csvText.trim().split(/\r?\n/).map(l => l.trim()).filter(l => l.length > 0);
            if (!lines.length) return [];
            // parse header
            const header = parseCsvLine(lines[0]);
            const objs = [];
            for (let i = 1; i < lines.length; i++) {
                const parts = parseCsvLine(lines[i]);
                // skip empty line
                if (parts.length === 0) continue;
                const obj = {};
                for (let j = 0; j < header.length; j++) {
                    obj[header[j].trim()] = parts[j] === undefined ? '' : parts[j].trim();
                }
                objs.push(obj);
            }
            return objs;
        }

        function parseCsvLine(line) {
            const res = [];
            let cur = '', inQuotes = false;
            for (let i = 0; i < line.length; i++) {
                const ch = line[i];
                if (inQuotes) {
                    if (ch === '"') {
                        if (line[i + 1] === '"') { cur += '"'; i++; } // escaped quote
                        else inQuotes = false;
                    } else cur += ch;
                } else {
                    if (ch === '"') inQuotes = true;
                    else if (ch === ',') { res.push(cur); cur = ''; }
                    else cur += ch;
                }
            }
            res.push(cur);
            return res;
        }

        /**********************
         * download current report area as PDF
         **********************/
        document.getElementById('downloadAllPdf').addEventListener('click', () => {
            const output = document.getElementById('reportsOutput');
            if (!output.innerHTML.trim()) {
                alert('No report to download. Generate a report first.');
                return;
            }

            // ðŸ”¥ FORCE WHITE MODE
            document.documentElement.classList.add('pdf-mode');

            // Convert QR canvases to images
            const qrCanvases = output.querySelectorAll('.qrCanvas');
            qrCanvases.forEach(canvas => {
                const img = document.createElement('img');
                img.src = canvas.toDataURL("image/png");
                img.width = canvas.width;
                img.height = canvas.height;
                img.className = "qrImage";
                canvas.replaceWith(img);
            });

            const opt = {
                margin: [0.4, 0.4, 0.4, 0.4],
                filename: 'Internship_Report_Cards.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: {
                    scale: 2,
                    useCORS: true,
                    backgroundColor: "#ffffff", // ðŸ”¥ FORCE
                    scrollY: 0
                },
                jsPDF: {
                    unit: 'in',
                    format: 'a4',
                    orientation: 'portrait'
                }
            };

            html2pdf().set(opt).from(output).save().then(() => {
                // ðŸ” RESTORE DARK UI AFTER PDF
                document.documentElement.classList.remove('pdf-mode');
            });
        });


        // simple small helper to load sample data quickly (uncomment if you want sample)
        // document.addEventListener('DOMContentLoaded', () => { /* optional sample fill */ });

    </script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script> -->










    <footer class="pt-5 pb-4 mt-5 position-relative">
        <div class="container">
            <div class="row gy-4">

                <!-- Brand -->
                <div class="col-lg-4 col-md-6">
                    <img src="img/navbar-logo.webp" alt="InternSpark Logo" class="footer-logo">

                    <p class="text-secondary mt-3">
                        InternSpark is an online internship & skill development platform
                        powered by InternSpark.
                    </p>

                    <!-- Social Media -->
                    <div class="d-flex gap-3 mt-3">
                        <a href="https://www.linkedin.com/company/internspark1/" target="_blank" class="footer-social"
                            aria-label="LinkedIn">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                        <a href="https://www.instagram.com/internspark1" target="_blank" class="footer-social"
                            aria-label="Instagram">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="https://x.com/internspark1" target="_blank" class="footer-social" aria-label="Twitter">
                            <i class="fab fa-x-twitter"></i>
                        </a>
                        <a href="https://www.youtube.com/@InternSpark" target="_blank" class="footer-social"
                            aria-label="YouTube">
                            <i class="fab fa-youtube"></i>
                        </a>
                    </div>
                </div>

                <!-- Quick Links -->
                <div class="col-lg-2 col-md-6">
                    <h6 class="fw-bold mb-3">Quick Links</h6>
                    <ul class="list-unstyled">
                        <li><a href="index.html" class="footer-link">Home</a></li>
                        <li><a href="domains.html" class="footer-link">Domains</a></li>
                        <li><a href="about.html" class="footer-link">About</a></li>
                        <li><a href="faq.html" class="footer-link">FAQ</a></li>
                        <li><a href="/sitemap.xml" class="footer-link">Sitemap</a></li>
                    </ul>
                </div>

                <!-- Legal -->
                <div class="col-lg-3 col-md-6">
                    <h6 class="fw-bold mb-3">Legal</h6>
                    <ul class="list-unstyled">
                        <li><a href="/privacy-policy.html" class="footer-link">Privacy Policy</a></li>
                        <li><a href="/terms.html" class="footer-link">Terms & Conditions</a></li>
                        <li><a href="/refund.html" class="footer-link">Refund Policy</a></li>
                        <li><a href="/disclaimer.html" class="footer-link">Disclaimer</a></li>
                        <li><a href="/accessibility.html" class="footer-link">Accessibility</a></li>
                    </ul>
                </div>

                <!-- Contact & Address -->
                <div class="col-lg-3 col-md-6">
                    <h6 class="fw-bold mb-3">Contact & Address</h6>

                    <p class="text-secondary small mb-2">
                        <i class="fas fa-map-marker-alt me-2 text-warning"></i>
                        Bengaluru, Karnataka â€“ 560095, India
                    </p>

                    <p class="text-secondary small mb-2">
                        <i class="fas fa-envelope me-2 text-warning"></i>
                        <a href="mailto:info@internspark.in" class="footer-link">
                            info@internspark.in
                        </a>
                    </p>

                    <p class="text-secondary small mb-2">
                        <i class="fas fa-phone me-2 text-warning"></i>
                        <a href="tel:+917093639415" class="footer-link">
                            +91 70936 39415
                        </a>
                    </p>

                    <p class="text-secondary small mb-0">
                        <i class="fas fa-headset me-2 text-warning"></i>
                        <a href="mailto:support@internspark.in" class="footer-link">
                            support@internspark.in
                        </a>
                    </p>
                </div>

            </div>

            <hr class="my-4 border-secondary">

            <!-- Bottom Bar -->
            <div class="d-flex flex-column flex-md-row justify-content-between align-items-center text-center">
                <p class="mb-2 mb-md-0 text-secondary small">
                Â© 2026 InternSpark | Operated under <a href="https://alfidotech.com">Alfido Tech</a>
                MSME (Udyam) Registration No: UDYAM-MP-10-0066163
            </p>
                <p class="text-secondary small mb-0">
                    Made with â¤ï¸ for learners
                </p>
            </div>

            <!-- Legal Safe Disclaimer -->
            <p class="text-secondary small text-center mt-3">
                InternSpark is a private skill-development initiative and is not affiliated
                with AICTE or any government organization.
            </p>
        </div>
    </footer>
    <!-- ================= Footer End ================= -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>




</body>

</html>